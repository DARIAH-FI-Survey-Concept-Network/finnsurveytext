---
title: "Tutorial2-Data_Exploration"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Tutorial2-Data_Exploration}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>", 
  fig.width=6, fig.height=6
)
```

## Introduction
This tutorial follows on from Tutorial 1 and guides you through an Exploratory Data Analysis (EDA) of data which has been prepared into CoNLL-U format. The EDA functions are contained in r/02_data_exploration.R.


First, install and load the `finnsurveytext` package as below:
(Other required packages such as `dplyr` and `stringr` will also be installed if they are not currently installed in your environment.)

```{r setup}
#install.packages("finnsurveytext")
#library(finnsurveytext)
devtools::load_all() # TO-DO: remove this load_all() line and uncomment the library() line. 
```

There are two sets of data files available within the package which could be used in this tutorial. These files have been created following the process demonstrated in Tutorial 1. 

### 1. Bullying Data
* data/conllu_bullying.rda
* data/conllu_bullying_iso.rda

### 2. Development Cooperation Data
* data/conllu_dev_q11_1.rda
* data/conllu_dev_q11_1_nltk.rda
* data/conllu_dev_q11_1_snow.rda
* data/conllu_dev_q11_2.rda
* data/conllu_dev_q11_2_nltk.rda
* data/conllu_dev_q11_3.rda
* data/conllu_dev_q11_3_nltk.rda

You can read these in as follows: 

```{r}
bullying <- conllu_bullying_iso
knitr::kable(head(bullying))
q11_1 <- conllu_dev_q11_1_nltk
```

### Get Summary Table
`fst_summarise`

This function creates a simple summary table for the data that shows the total number of word, number of unique words, and number of unique lemmas in the data. You can either view the table in the console, or define a variable which will contain this table

```{r}
fst_summarise(bullying)

q11_1_summary_table <- fst_summarise(q11_1)
q11_1_summary_table
```

`fst_summarise` takes 1 argument: 

1. `data` is output from data preparation, prepared data in CoNLL-U format, such as the output of `fst_prepare_connlu`. 


### Get Part-Of-Speech Summary Table 
`fst_pos`

This function creates a table which counts the number of words of each part-of-speech (POS) tag within the data.

```{r}
fst_pos(bullying)

q11_1_pos_table <- fst_pos(q11_1)
q11_1_pos_table
```

`fst_pos` takes 1 argument: 

1. `data` is output from data preparation, prepared data in CoNLL-U format, such as the output of `fst_prepare_connlu`. 

### Make Top Words Table
`fst_freq`

In contrast to the previous two functions, `fst_freq` displays results in a plot. This function creates a table of the most frequently occurring words in the data (noting that "stopwords" may have been removed in previous data preparation steps.) Optionally, you can indicate which POS tags to include. We run the function as follows: 

```{r}
fst_freq(bullying)
fst_freq(data = bullying, 
         number = 10, 
         pos_filter = c("NOUN", "VERB", "ADJ", "ADV"))
fst_freq(q11_1, 5)
fst_freq(q11_1, 5, c("NOUN", "VERB"))
```

`fst_freq` takes 3 arguments: 

1. `data` is output from data preparation, prepared data in CoNLL-U format, such as the output of `fst_prepare_connlu`. 
2. `number` is the number of top words to return, default is `20`.
3. `pos_filter` is an optional list of which POS tags to include such as c("NOUN", "VERB", "ADJ", "ADV"). The default is NULL, in which case all words in data are considered. 

### Make Top N-Grams Table
`fst_ngrams`

This function produces another plot, in this case of n-grams. A n-gram (eg. bigram/2-gram or trigram/3-gram) is a set of n words in order. In this function we're finding the most frequently-occurring sets of n words in the text. An argument, ngrams, of the function allows you to set the n-gram size as follows: 

```{r}
fst_ngrams(bullying)
fst_ngrams(q11_1, number = 10, ngrams=3)
fst_ngrams(q11_1, number=5, ngrams=4)
```

`fst_ngrams` takes 3 arguments:

1. `data` is output from data preparation, prepared data in CoNLL-U format, such as the output of `fst_prepare_connlu`. 
2. `number` is the number of top n-grams to return, default is `20`.
3. `ngrams` is the type of n-gram we want. The default is 2, bigrams. 


### Make Wordcloud
`fst_wordcloud`

This function will create a wordcloud plot for the data. There is an option to select only specific word types (POS tag). 

```{r}
fst_wordcloud(bullying)
fst_wordcloud(q11_1, 
              pos_filter = c("NOUN", "VERB", "ADJ", "ADV"))
```

`fst_wordclouds` takes 2 arguments: 

1. `data` is output from data preparation, prepared data in CoNLL-U format, such as the output of `fst_prepare_connlu`. 
2. `pos_filter` is an optional list of POS tags for inclusion in the wordcloud. The defaul is `NULL`.


### Perform Data Exploration
`fst_discovery`

This function enables the user to run all the above EDA activities in one function call. As such, `fst_summarise` and `fst_plot` are printed within R plots rather than the R console. 

```{r}
fst_discover(q11_1)
fst_discover(bullying, 
             freq_number = 10, 
             ngram_number=8, 
             ngrams = 2, 
             pos_filter = c("NOUN", "VERB", "ADJ", "ADV"))
```

The arguments of this function are: 

1. `data` is output from data preparation, prepared data in CoNLL-U format, such as the output of `fst_prepare_connlu`. 
2. `freq_number` is the number of top words to return, default is `20`.
3. `ngram_number` is the number of top n-grams to return, default is `20`.
4. `ngrams` is the type of n-gram we want. The default is 2, bigrams.                          5. `pos_filter` is an optional list of which POS tags to include such as c("NOUN", "VERB", "ADJ", "ADV"). The default is NULL, in which case all words in data are considered. `pos_filter` is applied to the Top Words table and the Wordcloud plot.
